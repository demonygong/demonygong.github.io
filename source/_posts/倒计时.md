---
title: 两小时倒计时
date: 2020-05-28 16:34:40
tags:
- js
---


&ensp;&ensp;&ensp;&ensp;因项目需求，自写倒计时两小时。时间可随意更改。
&ensp;&ensp;&ensp;&ensp;话不多说，直接上代码。
<!--more-->
```
var oTime=document.getElementById("time_ed");
    var test_id = eid;
    function check_time(t_time){
        if(t_time<10){
            t_time = '0'+t_time
        }
        return t_time
    }
    var all = 2 * 60 *60  //暂定总时长两小时，倒计时
    var s_time = 0	// 单个时长，从 0 开始
    if (null != window.localStorage.getItem('current_time:' + test_id)) {
        s_time = parseInt(window.localStorage.getItem('current_time:' + test_id))
        all = all - s_time;
    }
    window.localStorage.setItem('current_time:' + test_id, s_time);
    h_all = parseInt(all/(60*60));
    m_all = parseInt(all/(60))
    s_all = parseInt(all%60)
    var time = setInterval(() => {
        // 单个时长
        s_time++
        all--
        h = parseInt(all/(60*60))
        if(h>0){
            m = parseInt((all-60*60*h)/60)
        }else{
            m = parseInt(all/60)
        }
        s = parseInt(all%60)
        if(all<10){
            oTime.innerHTML = '00:00:'+check_time(s)
        }else if(all<60){
            oTime.innerHTML = '00:00:'+check_time(s)
        }else if(all<(60*60)){
            oTime.innerHTML = '00:'+check_time(m)+':'+check_time(s)
        }else{
            oTime.innerHTML = check_time(h)+ ':' + check_time(m)+':'+check_time(s)
        }
        if(oTime.innerHTML== '00:00:00'){
            layer.msg('时间已结束!');
            clearInterval(time);
            localStorage.removeItem('current_time:'+test_id)
            window.location.href="{:url('index/test/test', array('lid' => 0))}";
            return
        }
        if (time) {
            localStorage.setItem('current_time:' + test_id, s_time);
        }
    }, 1000);
```
&ensp;&ensp;&ensp;&ensp;因重复项多个，需要记录单个完成时长，所以上面的s_time是记录单个所需时长。oTime.innerHTML为html页面上插入的倒计时所剩时间的值。